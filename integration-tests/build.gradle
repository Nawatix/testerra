doNotPublish(this)

dependencies {
    compile driver_ui_desktop
    compile test_utils
    compile 'org.xmlunit:xmlunit-core:2.5.0'
}

test {
    useTestNG() {
        suites (
            'src/test/resources/CoreTestSuite.xml',
            'src/test/resources/ReportingTestSuite.xml'
        )
    }
}

task prepareTests(type: Test) {
    def nr = findProperty("nr")
    if (!nr) {
        println "Please use -P nr=NR as parameter"
        println "Skipping prepare tests task."
        return
    }
    println "Preparing Tests Nr " + nr + "..."

    setReportDir("report-testsundertest-0" + nr)

    useTestNG() {
        suites 'src/test/resources/testng/ReportTestsUnderTest' + nr + '.xml'
    }
    testLogging {
        outputs.upToDateWhen { false }
        showStandardStreams = true
    }
    options {
        systemProperties(System.getProperties())
    }
}

def setReportDir(reportdir) {
    def path = "."
    def modulename = "integration-tests"
    if (!projectDir.toString().contains(modulename)) {
        path = modulename
    }
    System.setProperty("fennec.reportdir", path + "/" + reportdir)
}