<template>
    <require from="components/test-duration-card/test-duration-card"></require>

    <mdc-layout-grid>
        <mdc-layout-grid-inner if.bind="!_methodDetails">
            <mdc-layout-grid-cell span="12">
                <mdc-linear-progress if.bind="loading"></mdc-linear-progress>
                <div else
                     mdc-ripple
                     class="alert vcenter hcenter"
                >
                    <mdc-icon class="big-icon sr1">find_in_page</mdc-icon>
                    <div mdc-headline4>Method not found</div>
                </div>
            </mdc-layout-grid-cell>
        </mdc-layout-grid-inner>
        <mdc-layout-grid-inner else>
            <mdc-layout-grid-cell span.bind="_lastScreenshot?7:9">
                <mdc-card>
                    <div class="card-content" mdc-body1>
                        <span class="badge status-${_methodDetails.methodContext.contextValues.resultStatus|statusClass} sr1"
                        >${_methodDetails.methodContext.contextValues.resultStatus|statusName}</span>
                        ${_methodDetails.methodContext.contextValues.name}
                    </div>
                    <mdc-list-divider></mdc-list-divider>
                    <div class="flex">
                        <ul class="mdc-list mdc-list--dense w50">
                            <li class="mdc-list-item reset-cursor">
                                <span class="secondary sr1">Class</span><a route-href="route: tests; params.bind: {class: _methodDetails.classStatistics.classIdentifier}">${_methodDetails.classStatistics.classIdentifier}</a>
                            </li>
                            <li class="mdc-list-item reset-cursor">
                                <span class="secondary sr1">Test Context</span>${_methodDetails.testContext.contextValues.name}
                            </li>
                            <li class="mdc-list-item reset-cursor">
                                <span class="secondary sr1">Suite</span>${_methodDetails.suiteContext.contextValues.name}
                            </li>
                            <li class="mdc-list-item reset-cursor">
                                <span class="secondary sr1">Thread</span><a route-href="route: threads; params.bind: {methodId: _methodDetails.methodContext.contextValues.id}">${_methodDetails.methodContext.threadName}</a>
                            </li>
                        </ul>
                        <ul class="mdc-list mdc-list--dense w50">
                            <li class="mdc-list-item reset-cursor" if.bind="_methodDetails.failedStep">
                                <span class="secondary sr1">Failed in</span><a route-href="route: steps;">${_methodDetails.failedStep.name}</a>
                            </li>
                            <li class="mdc-list-item reset-cursor" if.bind="_methodDetails.sessionContexts.length > 0">
                                <span class="secondary sr1">Sessions</span><span repeat.for="sessionContext of _methodDetails.sessionContexts">${sessionContext.sessionKey} (${sessionContext.metadata.browser}:${sessionContext.metadata.browserVersion})</span>
                            </li>
                        </ul>
                    </div>
                </mdc-card>
            </mdc-layout-grid-cell>
            <mdc-layout-grid-cell span="2" if.bind="_lastScreenshot">
                <mdc-card class="header-card">
                    <div mdc-subtitle2 class="card-headline">Last Screenshot</div>
                    <mdc-list-divider></mdc-list-divider>
                    <img src.bind="_lastScreenshot.relativePath"
                         class="thumbnail clickable"
                         click.delegate="_showScreenshot(_lastScreenshot)"
                         title="${_lastScreenshot.meta.Title}"/>
                </mdc-card>
            </mdc-layout-grid-cell>
            <mdc-layout-grid-cell span="3" position="right">
                <test-duration-card class="header-card"
                                    start.bind="_methodDetails.methodContext.contextValues.startTime"
                                    end.bind="_methodDetails.methodContext.contextValues.endTime"
                ></test-duration-card>
            </mdc-layout-grid-cell>

            <mdc-layout-grid-cell span="12">
                <mdc-tab-bar>
                    <mdc-tab repeat.for="route of _router.routes"
                             if.bind="route.nav"
                             icon.bind="route.settings.icon"
                             label="${route.title + ' ('+route.settings.count+')'}"
                             active.bind="route.navModel.isActive"
                             click.delegate="_tabClicked(route)"></mdc-tab>
                </mdc-tab-bar>
            </mdc-layout-grid-cell>
        </mdc-layout-grid-inner>
    </mdc-layout-grid>

    <router-view></router-view>

</template>
